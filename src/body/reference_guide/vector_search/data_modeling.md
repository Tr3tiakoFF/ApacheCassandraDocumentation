# Моделювання даних

Під час розробки додатків зі штучним інтелектом (AI) і машинним навчанням (ML) із використанням Vector Search, важливо враховувати кілька аспектів моделювання даних. Ці фактори допоможуть ефективно використовувати пошук у векторному просторі для отримання точних і швидких результатів.

## Представлення даних
Vector Search базується на представленні точок даних у вигляді векторів високої розмірності. Вибір способу представлення векторів залежить від природи даних.

- Текстові дані:
    - Використовуються техніки створення векторів, такі як word embeddings (наприклад, Word2Vec) або document embeddings (Doc2Vec), щоб перетворити текст у вектори.
    - Більш складні моделі, як-от Великі Мовні Моделі (LLMs) (наприклад, OpenAI GPT-4 або Meta LLaMA 2), також можуть створювати векторні подання.
    - Word2Vec: Створює фіксований вектор для кожного слова незалежно від контексту.
    - LLMs: Створюють контекстуальні вектори, тобто одне і те саме слово може мати різні вектори залежно від контексту.
- Зображення:
    - Представляються за допомогою глибоких нейронних мереж, таких як конволюційні нейронні мережі (CNNs), або за допомогою попередньо натренованих моделей, як-от CLIP.
    - Оберіть спосіб створення векторів, який найкраще передає ключові характеристики даних.

## Розмірність набору даних
- Єдина розмірність: Усі вектори повинні мати однакову кількість вимірів, оскільки операції, як-от скалярний добуток або косинусна схожість, потребують сумісності розмірів.
- Єдиний простір векторів: Всі вектори повинні бути створені в однаковому векторному просторі для забезпечення коректного порівняння. Використання однієї бібліотеки для створення векторів гарантує сумісність.
    - Наприклад, порівняння векторів, створених за допомогою Word2Vec та BERT, може бути проблематичним через різну архітектуру моделей.
- Фіксована розмірність векторів: Тип даних вектора має бути вектором із фіксованою довжиною, що складається з чисел із плаваючою комою. Розмірність задається моделлю створення векторів.

## Попередня обробка векторів
- Нормалізація
    - Масштабування даних так, щоб довжина вектора дорівнювала одиниці.
    - Кожен елемент вектора ділиться на довжину (L2-норму) вектора.
- Стандартизація
    - Зміщення (віднімання середнього значення) і масштабування (ділення на стандартне відхилення), щоб дані мали середнє значення 0 та стандартне відхилення 1.
- Важливі відмінності:
    - Нормалізація та стандартизація мають різне значення залежно від задачі.
    - Вибір правильної техніки залежить від характеристик ваших даних та цілей моделі машинного навчання.
- Попередня обробка може включати:
    - Очищення та токенізацію тексту.
    - Зміни розміру та нормалізацію зображень.
    - Обробку відсутніх значень.

### Нормалізація векторів
Нормалізація векторів — це процес, що забезпечує довжину (норму) кожного вектора у векторному просторі, рівну одиниці. Це досягається шляхом ділення кожного елемента вектора на його довжину (також відому як L2-норма або Евклідова норма).

Приклад:
Оригінальні вектори та їхні нормалізовані аналоги:

Оригінал: `[0.1, 0.15, 0.3]`
Нормалізовано: `[0.28, 0.42, 0.85]`
Чому це важливо:
- Осмислені порівняння:
Нормалізація дозволяє проводити порівняння між векторами, орієнтуючись на їх напрямки, а не на масштаб. Це особливо корисно для розрахунку косинусної схожості, де увага зосереджена на куті між векторами.
- Продуктивність:
Косинусна схожість і скалярний добуток еквівалентні для нормалізованих векторів, але скалярний добуток швидший на ~50%. Тому рекомендується використовувати його як функцію схожості.
- Уникнення помилок:
Якщо вектори не нормалізовані, скалярний добуток може повернути беззмістовні результати. Через це він не є функцією схожості за замовчуванням у Vector Search.

*Якщо ви використовуєте OpenAI, PaLM або Simsce для генерації векторів, вони вже нормалізовані. Для інших бібліотек варто самостійно нормалізувати вектори та налаштувати функцію схожості на скалярний добуток.*

### Стандартизація векторів
Стандартизація означає, що дані перетворюються так, щоб мати середнє значення `0` та стандартне відхилення `1`.

Коли це потрібно:
Моделі, що використовують відстані:
Якщо модель машинного навчання базується на обчисленні відстаней (наприклад, найближчі сусіди, Евклідова відстань), стандартизація забезпечує однаковий вплив усіх ознак на результати.

Нейронні мережі:
Стандартизовані дані сприяють кращому навчанню мережі, оскільки жодна ознака не домінує через масштаб.

## Індексація та зберігання
SAI (Storage-Attached Indexing) оптимізована для великих наборів даних, як-от Vector Search.

JVector (ANN):
Використовується для приблизного пошуку найближчих сусідів (ANN).
Принцип роботи:
Створюється ієрархія графів для швидкої навігації.
Верхні рівні забезпечують грубу навігацію, нижні — точну.
Вдосконалено завдяки використанню SIMD API для прискорення.

## Метрика схожості
Vector Search базується на обчисленні схожості між векторами. Основні метрики:

Косинусна схожість: Використовується за замовчуванням.
Скалярний добуток: Рекомендується для нормалізованих векторів через вищу швидкість.
Евклідова відстань: Для ненормалізованих векторів.

## Масштабованість і продуктивність
Vector Search ефективно розподіляє дані та обробляє великі набори, використовуючи паралельну обробку в Cassandra. Це дозволяє працювати із збільшенням обсягу даних.

## Оцінка та ітерація
Постійно оцінюйте результати пошуку та вносьте зміни:

Покращуйте векторні представлення.
Налаштовуйте метрики схожості.
Оптимізуйте методи індексації та попередньої обробки.

## Приклади використання
- Пошук подібних елементів без необхідності знати точну назву чи ID.
- Пошук документів на основі схожості контексту, а не точних ключових слів.
- Розширення результатів пошуку на інші категорії.
- Пошук за медіа-контентом (зображення, аудіо, відео).
- Автоматична генерація асоціацій між даними.
- Виявлення та видалення дублікатів.
## Найкращі практики
- Зберігайте метадані про вектор у тих самих таблицях.
- Обирайте попередньо натреновані моделі відповідно до типу запитів.
## Обмеження
- Нечитабельність: Вектори не підходять для прямого доступу до даних.
- Неповні результати: Модель може не охопити всі нюанси даних.
- Додатковий інструмент: Вектори доповнюють традиційні типи даних, але не замінюють їх.