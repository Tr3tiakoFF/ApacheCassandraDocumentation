# Проєктування в RDBMS

Коли ви починаєте створювати новий додаток, який використовуватиме реляційну базу даних, ви, ймовірно, почнете з моделювання домену як набір правильно нормалізованих таблиць і використаєте зовнішні ключі для зв'язку даних з іншими таблицями.

Реляційна модель включає кілька "join" таблиць для реалізації відносин багато до багато, таких як зв'язки між готелями та цікавими місцями, кімнатами та зручностями, кімнатами та доступністю, а також гостями та кімнатами (через бронювання).

## Різниці в проєктуванні між RDBMS та Cassandra

### Без з’єднань (Joins)
У Cassandra ви не можете використовувати з’єднання (joins). Якщо ваші дані потребують з’єднання, вам доведеться або виконати цю роботу на стороні клієнта, або створити денормалізовану другу таблицю, яка буде представляти результати з’єднання. Другий варіант є переважним у моделюванні даних Cassandra. Виконання з’єднань на стороні клієнта повинно бути дуже рідкісним. Краще денормалізувати дані для досягнення ефективності.

### Без посилань на цілісність даних (Referential Integrity)
Cassandra не підтримує концепцію посилань на цілісність між таблицями. У реляційній базі даних ви могли б вказати зовнішні ключі для посилання на основний ключ іншої таблиці, але Cassandra не буде цього контролювати. Тим не менш, часто в Cassandra зберігають ID зв’язаних сутностей у таблицях, але операції, як каскадне видалення, відсутні.

### Денормалізація
У реляційних базах даних часто наголошують на важливості нормалізації. Але це не перевага при роботі з Cassandra, оскільки вона працює найкраще, коли дані денормалізовані. У реляційних базах даних іноді теж відбувається денормалізація з двох основних причин: продуктивність (коли виконати з’єднання для обробки великих обсягів даних занадто важко) і потреби в збереженні історії документів (наприклад, для інвойсів).

У Cassandra денормалізація є нормою, і її не варто уникати. З 3.0 версії Cassandra надає можливість створювати матеріалізовані погляди (`materialized views`), що дозволяє створювати кілька денормалізованих представлень даних на основі базової таблиці.

### Проєктування, орієнтоване на запити
У реляційному моделюванні ви спочатку моделюєте домен даних, створюєте таблиці, визначаєте ключі та зовнішні ключі, а потім пишете запити. У Cassandra ж ви починаєте з проєктування запитів і моделюєте таблиці таким чином, щоб вони підтримували ці запити. Думати про запити першочергово – це важлива частина проєктування для забезпечення високої ефективності.

### Оптимізація зберігання
У реляційних базах даних часто не враховується, як таблиці зберігаються на диску. Але в Cassandra важливо враховувати це, оскільки кожна таблиця зберігається в окремих файлах на диску. З цієї причини треба прагнути зберігати пов’язані стовпці разом в одній таблиці. Однією з основних цілей при проєктуванні даних у Cassandra є мінімізація кількості розділів (partitions), які потрібно шукати, щоб задовольнити запит.


### Сортування як рішення проєктування
У реляційній базі даних можна легко змінювати порядок, в якому повертаються записи, за допомогою `ORDER BY` в запиті. В Cassandra ж порядок сортування є частиною проєктування і визначається вибором кластерних стовпців у команді `CREATE TABLE`. Сортування в Cassandra доступне лише за кластерними стовпцями в порядку, визначеному під час створення таблиці.
